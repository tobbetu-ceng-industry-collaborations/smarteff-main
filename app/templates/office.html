      <!DOCTYPE html>
      <html lang="en">
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <style type="text/css">
          .dot {
            height: 18px;
            width: 18px;
            background-color: green;
            border-radius: 50%;
            display: inline-block;
          }
          .dotRed {
            height: 18px;
            width: 18px;
            background-color: red;
            border-radius: 50%;
            display: inline-block;
          }
          .overlay{
            opacity:5;
            position:fixed;
            width:100%;
            height:100%;
            top:0px;
            left:0px;
            z-index:1000;
            border: 8px solid;
          }
          .overlay2{
            opacity:1;
            width:120%;
            height:170%;
            z-index:1000;
            border: 4px solid;
            margin-left: 65%;
            margin-top: 5%;

          }
          .overlay3{
            opacity:1;
            width:80%;
            height:140%;
            z-index:1000;
            border: 4px solid;
            margin-left: 10%;
            margin-top: 15%;
          }
          .overlay4{
            opacity:1;
            width:80%;
            height:140%;
            z-index:1000;
            border: 4px solid;
            margin-left: 100%;
            margin-top: -89%;
          }
          .overlay5{
            opacity:1;
            width:60%;
            height:60%;
            z-index:1000;
            border: 4px solid;
            margin-left: 100%;
            margin-top: 15%;
          }
          .overlay6{
            opacity:1;
            width:60%;
            height:60%;
            z-index:1000;
            border: 4px solid;
            margin-left: 100%;
            margin-top: 40%;
          }
          .overlay7{
            opacity:1;
            width:60%;
            height:60%;
            z-index:1000;
            border: 4px solid;
            margin-left: 100%;
            margin-top: 17%;
          }
          .overlay8{
            opacity:1;
            width:60%;
            height:60%;
            z-index:1000;
            border: 4px solid;
            margin-left: 100%;
            margin-top: 40%;
          }
          .overlay9{
            opacity:1;
            width:60%;
            height:60%;
            z-index:1000;
            border: 4px solid;
            margin-top: -175%;
            margin-left: 5%;
          }
          .overlay10{<!desk 4-->
            opacity:1;
            width:60%;
            height:60%;
            z-index:1000;
            border: 4px solid;
            margin-top: 40%;
            margin-left: 5%;
          }

          .flex-container {
            padding: 0;
            margin: 0;
            list-style: none;
            display: flex;
          }

          .flex-start {
            justify-content: flex-start;
          }

          .flex-end {
            justify-content: flex-end;
          }  
          .flex-end li {
            background: gold;
          }

          .center {
            justify-content: center;
          }  
          .center li {
            background: deepskyblue;
          }

          .space-between {
            justify-content: space-between;
          }  
          .space-between li {
            background: lightgreen;
          }

          .space-around {
            justify-content: space-around;
          }
          .space-around li {
            background: hotpink;
          }

          .space-evenly {
            justify-content: space-evenly;
          }
          .space-evenly li {
            background: #bada55;
          }

          .flex-item {
            background: tomato;
            padding: 5px;
            width: 60px;
            height: 50px;
            margin: 5px;
            line-height: 50px;
            color: white;
            font-weight: bold;
            font-size: 2em;
            text-align: center;
          }
          table {
            border-collapse: collapse;
            border-spacing: 0;
            width: 100%;
            border: 1px solid #ddd;
          }

          th, td {
            text-align: left;
            padding: 8px;
          }

          tr:nth-child(even){background-color: #f2f2f2}

        </style>
      </head>
      <body>
  <div id="myModal" class="modal">

        <!-- Modal content Pop-upýn kendisi-->
        <div class="modal-content" style="width: 15% ; margin-top:15.0%;margin-left: 40%;text-align:center;">
            <span class="close">&times;</span>
            <p2 id="p1">For Device Number </p2>
            <p2 id="p2">1</p2><br><br>
            <label for="username">Assign a User:</label>
            <select id="usernameS">
              {% for person in persons %}
              <option value={{person}}>{{person}}</option>
              {% endfor %}
            </select>
            <label for="username">Control Device: </label>
            <br><br>   
            <input type="submit" value="Submit" onclick="getInfo()">
            <br><br><br>
        </div>

    </div>

  <div class = "modal" style="display: none;" id="myModal2">

        <!-- Modal content Pop-upýn kendisi-->
        <div class = "modal-content" style="width: 15% ; height:20%;margin-top:15.0%;margin-left: 40%;text-align:center;">
            <span style="margin-left: 90%;" class="close2">&times;</span>
            <label>Create New Person</label> <br>
            <label>Person Name</label>
            <br>
            <input id="userNameInput" type="text">
            <br><br>
            <input type="submit" value="Submit" onclick="create_person()">
        </div>

    </div>


  <div class = "modal" style="display: none;" id="myModal3">

        <!-- Modal content Pop-upýn kendisi-->
        <div class = "modal-content" style="width: 15% ; height:22.5%;margin-top:15.0%;margin-left: 40%;text-align:center;">
            <span style="margin-left: 90%;" class="close3">&times;</span>
            <label>Manage Device</label> <br>
            <label for="username">Select a Device:</label>
            <select id="deviceName-3">
              <option value="D1">D1</option>
              <option value="D2">D2</option>
              <option value="D3">D3</option>
              <option value="D4">D4</option>
              <option value="D5">D5</option>
              <option value="D6">D6</option>
              <option value="D7">D7</option>              
              <option value="D8">D8</option>
              <option value="D9">D9</option>
            </select>
            <br>
            <input type="radio" id="on" name="status" value="turnon" checked>
            <label for="male">On</label><br>
            <input type="radio" id="off" name="status" value="turnoff">
            <label for="off">Off</label><br>
            <input type="submit" value="Submit" onclick="changeDeviceStatus()">
        </div>

    </div>

<form id="toPost" action="https://smarteff.herokuapp.com/ChangeAssignment" method="POST">
  <input id="name1" type="hidden" name="name1" value={{userBefore}}>
  <input id="name2" type="hidden" name="name2" value={{userAfter}}>
</form>

<form id="toPost2" action="https://smarteff.herokuapp.com/CreateNewPerson" method="POST">
  <input id="name" type="hidden" name="name" value={{userN}}>
</form>

<form id="toPost3" action="https://smarteff.herokuapp.com/HandleDeviceEventAdmin" method="POST">
  <input id="deviceid" type="hidden" name="deviceid" value={{devID}}>
  <input id="event" type="hidden" name="event" value={{event}}>
</form>

        <div style="width:500px;height:727px;border:4px solid #000;margin-left: 3%; margin-top: 2.9%;text-align: center;">
          <h3>Person List</h3>


                        
              <div style="overflow-x:auto;">
                <table>
                      <tr>
                        <th>Person Name</th>
                        <th>Is Inside</th>
                        <th>Assigned Device</th>
                      </tr>
                    {% for person in loaded['people'] %}
                      <tr>
                        <td>{{person.name}}</td>
                        {% if person.is_inside == 1 %}
                        <td>Yes</td>
                        {% else %}
                        <td>No</td>
                        {% endif %}
                        <td>{{person.devices}}</td>
                     </tr>
                    {% endfor %}

                </table>
              </div>
              
          </div>

        <div class="overlay">
          <br>
          <div style="display: inline-block; margin-left: 53%;">
          <button id="createPerson">Create Person</button>
          <button id="manageDevices">Manage Devices</button>
          </div>
          <div style="width: 50%; height: 50%;">
            <div class="overlay2" style="position: relative;">

              <div style="width: 50%;height: 50%">
                <div class="overlay3" style="position: relative;">
                  <div style="width: 50%;height: 50%">
                    <div class ="overlay5" style="position: relative;"> 
                      <img src="https://www.pngitem.com/pimgs/m/36-367738_customer-service-desk-icon-hd-png-download.png" width="40" height="50" onclick="popup(1)">
                      <div style="font-weight:bold; text-align:rigt;position: absolute; bottom:0; right: :0">D1 - Desk

                      </div>
                      <div id="D1"; style="font-weight:bold">
                      
                      {{devices["D1"]}}
                      
                      </div>
                      {% if device_status["D1"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
                    </div>
                    <div class ="overlay6" style="position: relative;">
                      <img src="https://www.pngitem.com/pimgs/m/36-367738_customer-service-desk-icon-hd-png-download.png" width="40" height="50" onclick="popup(2)">
                      <div style="font-weight:bold; text-align:left;position: absolute; bottom:0; left: :0">D2 - Desk
                      </div>
                      <div id="D2"; style="font-weight:bold">
                      {{devices["D2"]}}
                      </div>
                      {% if device_status["D2"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
                    </div>
                  </div>
                  <div style="font-weight:bold; text-align:left;position: absolute; bottom:0; left: :0">D7 - Lamp
                  </div>
                      {% if device_status["D7"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
                </div>
                <div class="overlay4" style="position: relative;">
                  <div style="width: 50%;height: 50%">
                    <div class="overlay7" style="position: relative;">
                      <img src="https://www.pngitem.com/pimgs/m/36-367738_customer-service-desk-icon-hd-png-download.png" width="40" height="50" onclick="popup(5)">
                      <div style="font-weight:bold; text-align:left;position: absolute; bottom:0; left: :0">D5 - Desk
                      </div>
                      <div id="D5"; style="font-weight:bold">
                      {{devices["D5"]}}
                      </div>
                      {% if device_status["D5"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
                    </div>
                    <div class="overlay8" style="position: relative;">
                      <img src="https://www.pngitem.com/pimgs/m/36-367738_customer-service-desk-icon-hd-png-download.png" width="40" height="50" onclick="popup(6)">
                      <div style="font-weight:bold; text-align:left;position: absolute; bottom:0; left: :0">D6 - Desk
                      </div>
                      <div id="D6"; style="font-weight:bold">
                      {{devices["D6"]}}
                      </div>
                      {% if device_status["D6"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
                    </div>

                    <div class="overlay9" style="position: relative;">
                     <img src="https://www.pngitem.com/pimgs/m/36-367738_customer-service-desk-icon-hd-png-download.png" width="40" height="50" onclick="popup(3)"> 
                      <div style="font-weight:bold; text-align:left;position: absolute; bottom:0; left: :0">D3 - Desk
                      </div>
                      <div id="D3"; style="font-weight:bold">
                      {{devices["D3"]}}
                      </div>
                      {% if device_status["D3"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
                   </div>
                   <div class="overlay10" style="position: relative;">
                     <img src="https://www.pngitem.com/pimgs/m/36-367738_customer-service-desk-icon-hd-png-download.png" width="40" height="50" onclick="popup(4)">
                      <div style="font-weight:bold; text-align:left;position: absolute; bottom:0; left: :0">D4 - Desk
                      </div>
                      <div id="D4"; style="font-weight:bold">
                      {{devices["D4"]}}
                      </div>
                      {% if device_status["D4"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
                   </div>
                 </div>
                  <div style="font-weight:bold; text-align:left;position: absolute; bottom:0; left: :0">D9 - Lamp
                  </div>  
                      {% if device_status["D9"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
               </div>
             </div>
              <div style="font-weight:bold; text-align:left;position: absolute; bottom:0; left: :0">D8 - Air Conditioner
              </div>  
                      {% if device_status["D8"] == 1 %}
                      <span class="dot" style="position: absolute; bottom:0; right:0"></span>
                      {% else %}
                      <span class="dotRed" style="position: absolute; bottom:0; right:0"></span>
                      {% endif %}
           </div>
         </div>
       </div>
    <script>

        document.getElementById("createPerson").addEventListener("click", popup2);
        document.getElementById("manageDevices").addEventListener("click", popup3);
        
        // Get the modal
        var modal = document.getElementById("myModal");

        // Get the button that opens the modal
        var btn = document.getElementsByClassName("desk");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        var span2 = document.getElementsByClassName("close2")[0];
        var span3 = document.getElementsByClassName("close3")[0];

        var temp = "";
        var userBefore = "";
        var userAfter = "";

        var userN = "";

        var curDev = 0;

        var devID = 0;
        var event = "";


        // When the user clicks the button, open the modal
        function popup(number) {
            modal.style.display = "block";
            var deskName = "D" + number;
            temp = deskName;
            curDev = number;
            

            document.getElementById("p2").innerHTML = number;
        }

        function popup2() {
            myModal2.style.display = "block";
  
        }
        function popup3() {
            myModal3.style.display = "block";
  
        }
        function create_person(){
            var userNameIn = document.getElementById("userNameInput");
            var nameUser = userNameIn.value;
            userN = nameUser;
            myModal2.style.display = "none";
            postToURL2("https://smarteff.herokuapp.com/CreateNewPerson");
        }

        //önemli!!!
        //Bilgiler girilip submite týklayýnca yazýlanlarý ceken metod
        function getInfo() {
            var username = document.getElementById("usernameS").value; //back-ende 
            var myElement = document.getElementById(temp);
            usernameBefore = myElement.innerHTML;
            myElement.innerHTML = username;
            userBefore = usernameBefore;
            userAfter = username;
            postToURL("https://smarteff.herokuapp.com/ChangeAssignment");
        }
        function changeDeviceStatus() {
            var radios = document.getElementsByName('status');
            var stat;
            for (var i = 0, length = radios.length; i < length; i++) {
                  if (radios[i].checked) {
                    // do whatever you want with the checked radio
                    stat = radios[i].value;

                    // only one radio can be logically checked, don't check the rest
                    break;
                   }
            }
            var devicename = document.getElementById("deviceName-3").value;
            var ID = devicename.substring(1);

            event = stat;
            devID = ID;

            myModal3.style.display = "None";
            postToURL3("https://smarteff.herokuapp.com/HandleDeviceEventAdmin");
        }
        function postToURL(a){
            document.getElementById("toPost").action     = a;
            document.getElementById("name1").value  = userBefore;
            document.getElementById("name2").value = userAfter;
            document.getElementById("toPost").submit();
         }
        function postToURL2(a){
            document.getElementById("toPost2").action     = a;
            document.getElementById("name").value  = userN;
            document.getElementById("toPost2").submit();
         }
        function postToURL3(a){
            document.getElementById("toPost3").action     = a;
            document.getElementById("deviceid").value  = devID;
            document.getElementById("event").value  = event;
            document.getElementById("toPost3").submit();
         }
        // When the user clicks on <span> (x), close the modal
        span.onclick = function () {
            modal.style.display = "none";

        }
        span2.onclick = function () {

            myModal2.style.display = "none";
        }
        span3.onclick = function () {

            myModal3.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
                
            }
        }
    </script>
    
</body>
</html>

